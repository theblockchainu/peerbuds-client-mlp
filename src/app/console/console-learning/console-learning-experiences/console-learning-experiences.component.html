<div class="row">
  <div class="col-md-12">
    <div *ngIf="!loaded" class="center">
      <i class="fa fa-spinner fa-spin" style="font-size:24px"></i>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12" *ngIf="loaded">
    <div #noContentView *ngIf="collections.data.length == 0" class="center" style="margin-top: 10%">
      <div class="lightText">
        You are not learning any experience
        <br><br>
        Start by signing up for a <a color="default" [routerLink]="'/feed/experiences'">Experience </a>
      </div>
    </div>
    <div *ngIf="collections.activeCount > 0">
      <div style="display:inline;">
        <h2>Ongoing & Upcoming</h2>
      </div>
      <div class="row">
        <div>
          <div style="margin-top:20px;" class="col-md-12">
            <div class="row">
              <div *ngFor="let collection of collections.data" [ngSwitch]="collection.status">
                <ng-template #topicName>{{collection.topics[0].name}}</ng-template>
                <ng-template #noTopicText>No Topics</ng-template>
                <ng-template #ongoingCard>
                  <mat-card style="text-align: center; padding: 20px;" >
                    <mat-card-content>
                      <div style="text-align: right">
                        <div class="pull-right">
                          <a [matMenuTriggerFor]="collectionCardMenu" style="text-align: right; padding: 0px">
                            <mat-icon>more_vert</mat-icon>
                          </a>
                        </div>
                      </div>
                      <div class="collectionParticipantImageCarousel">
                        <div class="circle-thumb-big" *ngFor="let owner of collection.owners">
                          <img src="{{ owner.profiles[0].picture_url }}" alt=" " class="circle-thumb" (error)="consoleLearningComponent.imgErrorHandler($event)">
                        </div>
                      </div>
                      <div class="teacherName">
                        <span>{{collection.owners[0].profiles[0].first_name + ' ' + collection.owners[0].profiles[0].last_name}} </span>
                      </div>
                      <div class="teacherHeadline">
                        <span>{{collection.owners[0].profiles[0].headline}} </span>
                      </div>
                      <div class="collectionTitle">{{ collection.title || 'No Title' }} </div>
                      <mat-progress-bar mode="determinate" value="{{consoleLearningComponent.getProgressValue(collection)}}"></mat-progress-bar>
                      <div class="collectionSubtitle" >
                        {{ consoleLearningComponent.getThisCollectionDate(collection) }} | {{collection.contents.length}} Parts | <span *ngIf="collection.topics.length > 0; then topicName else noTopicText"></span>
                      </div>
                      <p class="upcomingEventLabel">
                        Up Next
                      </p>
                      <div class="upcomingEventTitle">
                        {{ consoleLearningComponent.getLearnerUpcomingEvent(collection).title }}
                      </div>
                      <div class="upcomingEventTime">
                        {{ consoleLearningComponent.getLearnerUpcomingEvent(collection).type + ' ' + consoleLearningComponent.getLearnerUpcomingEvent(collection).fillerWord  + ' in ' +  consoleLearningComponent.getLearnerUpcomingEvent(collection).timeToStart + ' Days' }}
                      </div>
                    </mat-card-content>
                    <mat-card-actions *ngIf="consoleLearningComponent.getLearnerUpcomingEvent(collection).hasStarted">
                      <button mat-raised-button (click)="onSelect(collection)">{{consoleLearningComponent.getLearnerUpcomingEvent(collection).upcomingEventButtonText}}</button>
                    </mat-card-actions>
                    <br><br>
                    <mat-card-footer class="cardFooter">
                      <button mat-button (click)="consoleLearningComponent.viewReceipt(collection)">Receipt</button>
                    </mat-card-footer>
                  </mat-card>
                </ng-template>
                <ng-template #upcomingCard>
                  <mat-card style="text-align: center; padding: 20px;" >
                    <mat-card-content>
                      <div style="text-align: right">
                        <div class="pull-right">
                          <a [matMenuTriggerFor]="collectionCardMenu" style="text-align: right; padding: 0px">
                            <mat-icon>more_vert</mat-icon>
                          </a>
                        </div>
                      </div>
                      <div class="collectionParticipantImageCarousel">
                        <div class="circle-thumb-big" *ngFor="let owner of collection.owners">
                          <img src="{{ owner.profiles[0].picture_url }}" alt=" " class="circle-thumb" (error)="consoleLearningComponent.imgErrorHandler($event)">
                        </div>
                      </div>
                      <div class="teacherName">
                        <span>{{collection.owners[0].profiles[0].first_name + ' ' + collection.owners[0].profiles[0].last_name}} </span>
                      </div>
                      <div class="teacherHeadline">
                        <span>{{collection.owners[0].profiles[0].headline}} </span>
                      </div>
                      <div class="collectionTitle">{{ collection.title || 'No Title' }} </div>
                      <div class="lighterText">
                        Booked {{consoleLearningComponent.getDaysBetween(collection.updatedAt, now)}}
                      </div>
                      <div class="collectionSubtitle" >
                        {{ consoleLearningComponent.getThisCollectionDate(collection) }} | {{collection.contents.length}} Parts | <span *ngIf="collection.topics.length > 0; then topicName else noTopicText"></span>
                      </div>
                      <p class="upcomingEventLabel">
                        First Session
                      </p>
                      <div class="upcomingEventTitle">
                        {{ consoleLearningComponent.getLearnerUpcomingEvent(collection).title }}
                      </div>
                      <div class="upcomingEventTime">
                        {{ consoleLearningComponent.getLearnerUpcomingEvent(collection).type + ' ' + consoleLearningComponent.getLearnerUpcomingEvent(collection).fillerWord  + ' in ' +  consoleLearningComponent.getLearnerUpcomingEvent(collection).timeToStart + ' Days' }}
                      </div>
                    </mat-card-content>
                    <mat-card-actions *ngIf="consoleLearningComponent.getLearnerUpcomingEvent(collection).hasStarted">
                      <button mat-raised-button (click)="onSelect(collection)">{{consoleLearningComponent.getLearnerUpcomingEvent(collection).upcomingEventButtonText}}</button>
                    </mat-card-actions>
                    <br><br>
                    <mat-card-footer class="cardFooter">
                      <button mat-button (click)="consoleLearningComponent.viewReceipt(collection)">Receipt</button>
                    </mat-card-footer>
                  </mat-card>
                </ng-template>
                <div class="col-md-4" style="margin-top: 20px;" *ngSwitchCase="'active'">
                  <div *ngIf="consoleLearningComponent.getLearnerCalendar(collection).startDate > now; then ongoingCard else upcomingCard">
                    <!--show card template here-->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <br><br>
    </div>
    <div *ngIf="collections.pastCount > 0">
      <div style="display:inline;">
        <h2>Past</h2>
      </div>
      <div class="row">
        <div>
          <div style="margin-top:20px;" class="col-md-12">
            <div class="row">
              <div *ngFor="let collection of collections.data" [ngSwitch]="collection.status">
                <div class="col-md-4" style="margin-top: 20px;" *ngSwitchCase="'complete' || 'canceled'" >
                  <mat-card style="text-align: center; padding: 20px;">
                    <mat-card-content>
                      <div class="clearfix" style="text-align: right">
                        <div class="pull-right">
                          <a mat-button [matMenuTriggerFor]="collectionCardMenu" style="text-align: right; padding: 0px">
                            <mat-icon>more_vert</mat-icon>
                          </a>
                        </div>
                      </div>
                      <div class="collectionParticipantImageCarousel">
                        <div class="circle-thumb-big" *ngFor="let owner of collection.owners">
                          <img src="{{ owner.profiles[0].picture_url }}" alt=" " class="circle-thumb" (error)="consoleLearningComponent.imgErrorHandler($event)">
                        </div>
                      </div>
                      <div class="teacherName">
                        <span>{{collection.owners[0].profiles[0].first_name + ' ' + collection.owners[0].profiles[0].last_name}} </span>
                      </div>
                      <div class="teacherHeadline">
                        <span>{{collection.owners[0].profiles[0].headline}} </span>
                      </div>
                      <div style="margin-top: 30px; margin-bottom: 30px">{{ collection.title || 'No Title' }} </div>
                      <mat-progress-bar mode="determinate" value="{{consoleLearningComponent.getProgressValue(collection)}}"></mat-progress-bar>
                      <div class="collectionSubtitle" >
                        {{ consoleLearningComponent.getThisCollectionDate(collection) }} | {{collection.contents.length}} Parts | <span *ngIf="collection.topics.length > 0; then topicName else noTopicText"></span>
                      </div>
                    </mat-card-content>
                    <mat-card-actions>
                      <button mat-raised-button (click)="consoleLearningComponent.viewExperience(collection)">View Details</button>
                    </mat-card-actions>
                    <p class="upcomingEventLabel" *ngIf="consoleLearningComponent.peerHasReview(collection)">
                      {{collection.owners[0].profiles[0].first_name}} gave you a review
                    </p>
                    <br><br>
                    <mat-card-footer class="cardFooter">
                      <button mat-button (click)="consoleLearningComponent.viewReceipt(collection)">Receipt</button>
                    </mat-card-footer>
                  </mat-card>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<mat-menu #collectionCardMenu>
  <button mat-menu-item>
    Cancel
  </button>
  <button mat-menu-item>
    Message Teacher
  </button>
</mat-menu>
