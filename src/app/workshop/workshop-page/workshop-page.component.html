<div id="content">
  <div *ngIf="workshop">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        <div class="row workshop-header">
          <div class="col-md-8">
            <div class="row">
              <div class="col-md-12">
                <h1>{{workshop.title}}</h1>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12" *ngIf="userType==='teacher'">
                {{calendarDisplay.startDate}} - {{calendarDisplay.endDate}} {{totalDuration}} Hours . {{workshop.contents.length}} parts
                <i class="fa fa-calendar" aria-hidden="true" (click)="changeDates()"> Change Dates</i>
              </div>
              <div class="col-md-12" *ngIf="userType==='public'">
                <p>{{itenaryArray.length}} days / {{totalDuration}} Hours . {{workshop.contents.length}} parts</p>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="row" *ngIf="userType==='teacher'">
              <div class="col-md-11">
                <button type="button" class="btn btn-default pull-right" (click)="joinGroupChat()">  Join Group Chat  </button>
                <button type="button" class="btn btn-default pull-right" (click)="gotoEdit()">  Edit  </button>
              </div>
              <div class="col-md-1">
                <span class="glyphicon glyphicon-option-vertical" aria-hidden="true" placement="right" data-toggle="dropdown" aria-haspopup="true"
                  aria-expanded="false"></span>
                <ul class="dropdown-menu">
                  <li *ngIf="booked"><a (click)="cancelWorkshopModal.show()">Cancel Workshop</a></li>
                  <li *ngIf="!booked"><a (click)="deleteWorkshopModal.show()">Delete Workshop</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <hr>
        <div class="row workshop-content">
          <div class="col-md-8 left-content">
            <div class="row About">
              <div class="col-md-8">
                <h3>About this Workshop</h3>
                <h4 *ngIf="userType==='teacher' || userType==='participant'">{{workshop.headline}}
                  <a (click)="workshopVideoDialog.show()">
                      Watch Explainer Video <i class="fa fa-play-circle" aria-hidden="true"></i>                      
                    </a>
                </h4>
                <p> {{workshop.description}} </p>
              </div>
            </div>
            <div class="row Topics">
              <div class="col-md-8">
                <md-chip-list>
                  <md-chip *ngFor="let topic of workshop.topics"> {{topic.name}} </md-chip>
                </md-chip-list>
              </div>
            </div>
            <hr>
            <div class="row Description" *ngIf="userType==='public' || userType==='participant'">
              <div class="col-md-12">
                <div class="row">
                  <div class="col-md-4">
                    Who Should Come
                  </div>
                  <div class="col-md-8">
                    <h3>{{workshop.difficultyLevel}}</h3>
                    <p>{{workshop.notes}}</p>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4">Cancellation Policy </div>
                  <div class="col-md-8">Before {{workshop.cancellationPolicy}} days </div>
                </div>
              </div>
            </div>
            <hr>
            <div class="row Itenary">
              <div class="featurette" id="about">
                <div class="col-md-12">
                  <div class="qa-message-list" id="wallmessages">
                    <div class="message-item" *ngFor="let itenary of itenaryArray">
                      <div class="message-inner">
                        <div class="qa-message-content">
                          <div class="container">
                            <div class="row">
                              <div class="col-md-8"> {{itenary.startDate}} </div>
                            </div>
                            <div class="row" *ngFor="let content of itenary.contents" (click)="openModal(content,viewOnlineContent,viewVideoContent,viewProjectContent)">
                              <div class="col-md-4" style="object-fit:contain">
                                <img class="img-responsive" style="max-height:200px" src="{{config.apiUrl+content.imageUrl}}">
                              </div>
                              <div class="col-md-4">
                                <div class="row">
                                  <div class="col-md-12">
                                    <h3> {{content.title}}</h3>
                                    <h4> {{content.type}} content </h4>
                                  </div>
                                </div>
                                <div class="row">
                                  <div class="col-md-12">
                                    <p> {{content.description}} </p>
                                  </div>
                                </div>
                                <div class="row" *ngIf="content.type==='online' && (userType==='teacher' || userType==='participant')">
                                  <div class="col-md-12">
                                    <button class="btn btn-default" *ngIf="isLive(content)" (click)="joinSession(content)">Join</button>
                                    <button class="btn btn-default" *ngIf="!isLive(content)" [disabled]="true"> {{timetoSession(content)}} </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <hr>
            <div class="row Discussion" *ngIf="userType==='teacher' || userType==='participant'">
              <div class="col-md-12">
                <h3>Discussion</h3>
                <form [formGroup]="chatForm" (ngSubmit)="postMessage()">
                  <input type="text" formControlName="message" class="form-control" placeholder="Post your thoughts in this project">
                  <!-- <input type="checkbox" class="checkbox" formControlName="announce">Make announcement -->
                  <button type="submit" [disabled]="!chatForm.valid" class="btn btn-success pull-right">Submit</button>
                </form>
              </div>
              <div class="col-md-12">
                <!-- [[DISSCUSSION]] -->
              </div>
            </div>
            <div class="row Reviews">
              <hr>
              <div class="row">
                <div class="col-md-12">
                  <h4>Reviews ({{workshop.reviews.length}})</h4>
                  <rating [(ngModel)]="userRating" [max]="maxRating" [readonly]="isReadonly"></rating>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-md-11 col-md-offset-1">
                  <div class="row" *ngFor="let review of workshop.reviews;let i=index">
                    <div class="col-md-12" [hidden]="i>noOfReviews">
                      <div class="row">
                        <div class="col-md-2">
                          <img src="" alt="dp">
                        </div>
                        <div class="col-md-10">
                          <div class="row">
                            <div class="col-md-12">
                              Anonymous
                            </div>
                            <div class="col-md-12">
                              <p>{{getReadableDate(review.startDate)}}</p>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-12">
                          {{review.description}}
                        </div>
                      </div>
                      <br>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-12">
                      <hr>
                      <a [hidden]="noOfReviews!==4" (click)="toggleReviews()">See all {{workshop.reviews.length}} reviews</a>
                      <a [hidden]="noOfReviews===4" (click)="toggleReviews()">See fewer reviews</a>
                      <hr>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <hr>
            <div class="row Eligibility" *ngIf="userType==='teacher'">
              <div class="col-md-8">
                <div class="row">
                  <div class="col-md-4">
                    <h4>Who Should Come</h4>
                  </div>
                  <div class="col-md-6">
                    <h4>{{workshop.difficultyLevel}}</h4>
                    <p>{{workshop.notes}}</p>
                  </div>
                </div>
              </div>
              <div class="col-md-8">
                <div class="row">
                  <div class="col-md-4">
                    <h4>Cancellation Policy</h4>
                  </div>
                  <h4>
                    <div class="col-md-6">{{workshop.cancellationPolicy}} days</div>
                  </h4>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-3 col-md-offset-1 right-content">
            <div class="row" *ngIf="userType==='teacher'">
              <h3>Attendies</h3>
              <div class="row" *ngFor="let participant of workshop.participants; let i=index">
                <div *ngIf="participant.profiles && i<4">
                  <div class="col-md-2">
                    <img src="{{config.apiUrl+participant.profiles[0].picture_url}}" class="img-circle" alt="dp">
                  </div>
                  <div class="col-md-4">
                    {{participant.profiles[0].first_name +' '+participant.profiles[0].last_name }}
                  </div>
                  <div class="col-md-4" *ngIf="participant.profiles[0].work">{{participant.profiles[0].work[0].position}}</div>
                </div>
              </div>
              <div>
                <a (click)="viewAttendies.show()"> View All Peers </a>
              </div>
            </div>
            <div class="row" *ngIf="userType==='public'">
              <div class="row">
                <div class="col-md-12">
                  <carousel>
                    <slide>
                      <video autoplay loop muted height="100%" class="center-block" src="{{config.apiUrl+workshop.videoUrl}}" (click)="workshopVideoDialog.show()"></video>
                    </slide>
                    <slide *ngFor="let imageUrl of workshop.imageUrls">
                      <img src="{{config.apiUrl+imageUrl}}" class="img-responsive center-block" style="max-height: 100%" alt="First slide">
                    </slide>
                  </carousel>
                  <h4>
                    {{workshop.headline}}
                  </h4>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-md-12">
                  <h4>Taught By</h4>
                  <div class="row">
                    <div class="col-md-3">
                      <img src="{{config.apiUrl+workshop.owners[0].profiles[0].picture_url}}" class="img-circle">
                    </div>
                    <div class="col-md-9">
                      <div class="row">
                        <div class="col-md-12">
                          {{workshop.owners[0].profiles[0].first_name +workshop.owners[0].profiles[0].last_name}}
                        </div>
                        <div class="col-md-12">
                          {{workshop.owners[0].profiles[0].work[0].position}}
                        </div>
                      </div>

                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-12">
                      <p>{{workshop.aboutHost}}</p>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-12">
                      <p>Offered in {{workshop.language[0]}}</p>
                    </div>
                    <div class="col-md-12">
                      {{getContentCount('project')}} Project
                    </div>
                    <div class="col-md-12">
                      {{getContentCount('video')}} Recorded Videos
                    </div>
                  </div>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-md-8">
                  <div class="row">
                    <div class="col-md-3">
                      <h3>{{workshop.currency+ workshop.price}}</h3>
                    </div>
                    <div class="col-md-6">
                      <p>per person</p>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-12">
                      <rating [(ngModel)]="userRating" [max]="maxRating" [readonly]="isReadonly"></rating>
                      <p> {{workshop.reviews.length}} Reviews</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <button class="btn btn-default">Dates</button>
                </div>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-md-4">
                <a>Invite</a>
              </div>
              <div class="col-md-4">
                <span class="glyphicon glyphicon-bookmark" aria-hidden="true">Bookmark</span>
              </div>
              <div class="col-md-4">
                <i class="fa fa-linkedin" aria-hidden="true"></i>
                <i class="fa fa-twitter" aria-hidden="true"></i>
              </div>
            </div>
          </div>
        </div>
        <div class="row workshop-suggestions">
        </div>
      </div>
    </div>
    <div bsModal #workshopVideoDialog="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog  modal-lg">
        <div class="modal-content">
          <div class="modal-body" *ngIf="workshop.videoUrl" class="embed-responsive embed-responsive-16by9">
            <video controls height="600" easing="ease-in" class="embed-responsive-item" src="{{config.apiUrl+workshop.videoUrl}}"></video>
          </div>
        </div>
      </div>
    </div>
    <div bsModal #deleteWorkshopModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog  modal-sm">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title pull-left">Delete Workshop</h4>
          </div>
          <div class="modal-body">
            <p>
              Are you sure you want to delete this workshop?
            </p>
            <button class="btn btn-danger btn-lg" (click)="deleteWorkshop()"> I Agree Delete Anyways</button>
          </div>
        </div>
      </div>
    </div>
    <div bsModal #cancelWorkshopModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog  modal-sm">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title pull-left">Cancel Workshop</h4>
          </div>
          <div class="modal-body">
            <p>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam pellentesque urna id arcu aliquam, in iaculis nunc eleifend.
              Proin gravida massa et magna viverra, rhoncus cursus urna rhoncus.
            </p>
            <button class="btn btn-success btn-lg" (click)="cancelWorkshop()"> I Agree Cancel Anyways</button>
          </div>
        </div>
      </div>
    </div>

    <div bsModal #viewAttendies="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog  modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title pull-left">Attendies</h4>
          </div>
          <div class="modal-body" *ngIf="workshop">
            <div class="row" *ngFor="let participant of workshop.participants">
              <div *ngIf="participant.profiles">
                <div class="col-md-2">
                  <img src="{{config.apiUrl+participant.profiles[0].picture_url}}" class="img-circle" alt="dp">
                </div>
                <div class="col-md-3">
                  {{participant.profiles[0].first_name +' '+participant.profiles[0].last_name }}
                </div>
                <div class="col-md-3">
                  <div *ngIf="participant.profiles[0].work">{{participant.profiles[0].work[0].position}}</div>
                </div>
                <div class="col-md-3">
                  <md-progress-bar [mode]="determinate" [value]="2">
                  </md-progress-bar>
                </div>
                <div class="col-md-1">
                  <span class="glyphicon glyphicon-option-vertical" aria-hidden="true" placement="right" data-toggle="dropdown" aria-haspopup="true"
                    aria-expanded="false"></span>
                  <ul class="dropdown-menu">
                    <li><a (click)="messageParticipant(messageDialog,participant)">Message</a></li>
                    <li><a (click)="removeParticipant(participant.id)">Remove</a></li>
                    <li><a>Report</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div bsModal #viewOnlineContent="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog  modal-lg">
        <div class="modal-content">
          <div class="modal-body row" *ngIf="modalContent">
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-8 col-md-offset-2 media">
                  <img class="img-responsive media-middle" src="{{config.apiUrl+modalContent.imageUrl}}" style="max-height: 600px" alt="content Image">
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <h2>{{modalContent.title}}</h2>
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <h4>What we'll do</h4>
                  <p>
                    {{modalContent.description}}
                  </p>
                  <div *ngIf="modalContent.notes">
                    <hr>
                    <h4>Need to know</h4>
                    <p>
                      {{modalContent.notes}}
                    </p>
                  </div>
                </div>
              </div>
              <div class="row" *ngIf="modalContent.type==='online'">
                <div class="col-md-12">
                  <button class="btn btn-default" *ngIf="isLive(modalContent)" (click)="joinSession(modalContent)">Join</button>
                  <button class="btn btn-default" *ngIf="!isLive(modalContent)" [disabled]="true"> {{timetoSession(modalContent)}} </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div bsModal #viewVideoContent="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog  modal-lg">
        <div class="modal-content">
          <div class="modal-body row" *ngIf="modalContent">
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-8 col-md-offset-2 embed-responsive embed-responsive-16by9">
                  <video class="embed-responsive-item" controls src="{{config.apiUrl+modalContent.imageUrl}}">
                  </video>
                </div>
                <div class="col-md-12">
                  <h2>{{modalContent.title}}</h2>
                </div>
                <div class="col-md-12">
                  <p>{{modalContent.description}}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div bsModal #viewProjectContent="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog  modal-lg">
        <div class="modal-content">
          <div class="modal-body row" *ngIf="modalContent">
            <div class="col-md-12">
              <div class="row">
                <div class="col-md-8 col-md-offset-2 media">
                  <img class="img-responsive media-middle" src="{{config.apiUrl+modalContent.imageUrl}}" style="max-height: 600px" alt="content Image">
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <h2>{{modalContent.title}}</h2>
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <h4>What we'll do</h4>
                  <p>
                    {{modalContent.description}}
                  </p>
                  <div *ngIf="modalContent.notes">
                    <hr>
                    <h4>Need to know</h4>
                    <p>
                      {{modalContent.notes}}
                    </p>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-12">
                  <button *ngIf="userType==='participant'" class="btn btn-default pull-left">Submit Entree</button>
                  <button *ngIf="userType==='teacher'" class="btn btn-default pull-left">View Entries</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div bsModal #messageDialog="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog  modal-lg">
        <div class="modal-content">
          <div class="modal-body row" *ngIf="messagingParticipant">
            <div class="col-md-12">
              <h4>Send message to {{messagingParticipant.profiles[0].first_name}}</h4>
            </div>
            <div class="col-md-12">
              <form [formGroup]="messageForm" (ngSubmit)="sendMessage()">
                <input type="text" formControlName="message" class="form-control" placeholder="Type something to send...">
                <button type="submit" [disabled]="!messageForm.valid" class="btn btn-success pull-right">Submit</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


</div>